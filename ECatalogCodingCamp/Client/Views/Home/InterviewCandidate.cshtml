@{ ViewData["Title"] = "E-Catalogue Coding Camp";
    Layout = "/Views/Shared/_LayoutCandidate.cshtml"; }

<div class="container">
    <table id="table_id" class="display">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Bid Salary</th>
                <th>Interview Schedule</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            
        </tbody>
    </table>
</div>

<div class="modal fade" id="book" tabindex="-1" role="dialog" aria-labelledby="add" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="intrequest">Interview Request</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="formdata" class="needs-validation">
                    <input type="hidden" class="form-control" id="id">

                    <div class="form-group row">
                        <label for="salary" class="col-sm-2 col-form-label">Salary</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="salary" name="salary" placeholder="Bid Your Salary for this Candidate" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                            <div class="invalid-feedback">
                                Please fill name.
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="interviewdate" class="col-sm-2 col-form-label">Interview Date</label>
                        <div class="col-sm-10">
                            <input type="date" class="form-control" id="interviewdate" name="interviewdate" placeholder="Place your Inteview Date" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                            <div class="invalid-feedback">
                                Please Choose Interview Date.
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <div class="form-group row">
                            <div class="col-sm-10">
                                <button id="submit" type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(document).ready(function () {
            getCandidate();
        });

        let getClientById = id => {
            $('#table_id').DataTable({
                ajax: {
                    url: `GetClient/${id}`,
                    dataSrc: ''
                },
                columns: [
                    { data: 'Name' },
                    { data: 'Email' },
                    { data: 'Phone' },
                    { data: 'BidSalary' },
                    { data: 'Schedule' },
                    //{
                    //    "render": function (data, type, row) {
                    //        return `<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#yes" onclick="getId(' + row.id + ')" data-toggle="tooltip" data-placement="top" title="Confirm">Confirm</button>`
                    //            +
                    //            /*` <button class="btn btn-danger" data-bs-toggle="modal" data-toggle="tooltip" onclick="getById(${row.id})" data-placement="top" title="Reschedule">Reschedule</button>`;*/
                    //    },
                    //    "orderable": false,
                    //    "searchable": false
                    //},

                ]
            });
        }

        let getCandidate = () => {
            $.ajax({
                type: 'GET',
                url: `GetCandidateId`
            }).done(result => {
                let json = JSON.parse(result);
                getClientById(json[0].Id);
            }).fail(result => {
                console.log(result);
            })
        }

        let getById = id => {
            $.ajax({
                url: `GetById/`,
                type: `GET`,
                data: { "id": id },
                dataSrc: "",
                success: data => {
                    let jsonResult = JSON.parse(data);
                    $(`#id`).val(jsonResult.id);
                    let myModal = $("#book");
                    myModal.modal("show");
                },
                error: data => {
                    console.log(data);
                }
            })
        }
    </script>

}